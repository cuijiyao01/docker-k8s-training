# Trainer Guide

## Overview

#### Course Prep steps
These are the logical steps for a trainer to prep for a course (details below):
- Create a Gardener trial cluster for your training
- Download your trainer .kube/config from Gardener that lets you control the cluster
- On your VM, run the script to generate the kube configs for the participants
- Copy the generated configs to the config share of this course
- Print the access IDs sheet to be handed out to the participants (with their config IDs)

All artifacts / scripts / info needed as trainer is in this admin folder.
You can use the participant VM also for all work as a trainer.

#### Sending out prep mail to participants




## Course preparation

### Create a Gardener Trial Cluster for the training

For each training we are using a separate **trial cluster** that you get from [Gardener](https://github.wdf.sap.corp/pages/kubernetes/gardener/).

**TODO: description HOWTO**


### Download your trainer .kube/config

In Gardener
- Login to gardener (with SSO via 'Test the self-service')
- Choose your cluster
- in `kube cluster access` pane, click on on Kubeconfig and copy the yaml

On your VM / machine
- Create a directory `.kube` under HOME (e.g. /home/vagrant on VM) and cd into it
- Create new file `config` and paste the yaml
- run `kubectl get nodes` - this command must complete by giving you a short list of nodes in the cluster


### Generate the kube configs for the participants

Download or clone this repo into the VM / your linux machine.

CD into `./docker-k8s-training/admin/kubecfggen` and there do `chmod 755 kubecfggen.sh`.

Now run the script `kubecfggen.sh`. Give it the number of participants/namespaces it should create (e.g. `kubecfggen.sh 10` creates 10 different namespaces for 10 participants).
- It creates a new directory with a new training ID `training-xxxxxxxx` (8 char ID) where all generated files will be.
- Generates a yaml to create all namespaces etc in the cluster and already execute / apply it. The cluster will then already be set up for the participants.
- Generates the kubeconfig files for the participants in the subdir for the training
- Packages all files for this training into a tar.

### Copy the configs to the share

Upload the tar file using this Jenkins job: https://cc-admin.mo.sap.corp/view/K8s/job/upload-k8s-training-namespaces/

Participants will download 'their config' using the trainings and participant ID.


### Print the participant config codes sheet

Print the file that was generated by the `kubecfggen` run that contains the trainings ID and config codes for each participant. Cut the page at the lines so that you can hand out each code to one participant.


## Sending the preparation mail to participants

You should send a 'preparation mail' to all participants a few days before the course starts. You should add the below information in your mail:

```
------- add this info
- Please follow these instructions to download a VM and prep for the course:
  https://github.wdf.sap.corp/slvi/docker-k8s-training/blob/master/preparation.md
---------- end -----------
```

### Setup a docker registry
For the docker exercises you need a private docker registry. Participants will upload their custom images to it during the course. Recommendation is to spin up a registry without any persistence in the k8s cluster you use for the training.
In the admin folder of this repo, you find a registry folder with `install.registry.sh` script. Check the prerequisites and run the script as described [here](./registry/readme.md) to deploy a registry and make it available via an ingress.

## During the Course




## After the course

- Destroy the Gardener trial cluster you used for the training
- Delete the kube config files you stored for your training at `\\dwdf212\bst_ecf\X_Public\CloudCurriculum\K8S\k8s-for-developers\kube-configs`
